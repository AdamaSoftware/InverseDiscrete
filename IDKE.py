from hashlib import sha256
from secrets import randbelow as randint

m = 10149176142605696715050247890886518684869103063509537620648493592653337479126199564779492324587095488340968978086015701129456592142832211053079944961964657
phi_m = 10149176142605696715050247890886518684869103063509537620648493592653337479125996503442675300056368522775758150165989588230953032145289349735940133307374080
g = 7591750238283022226591624292439856861266114590948725596089923869315745586749399736727671118946044001928889845078615515383621527746449037726675666424737183
y = 2891056567964536419792226341900413927324947280774856569161137065304101982988190331398099565097205452998393309058780684180528268411016489168811183745218800

def keygen():
    sk = randint(phi_m - 3) + 2
    P_A = pow(g, sk, m)
    pk = pow(P_A, y, m)
    return pk, sk

def hash(data):
    shared_bytes = data.to_bytes((data.bit_length() + 7) // 8, 'big')
    return sha256(shared_bytes).digest()

def encaps(pk):
    pks, sks = keygen()
    shared_secret = pow(pk, sks, m)
    ss = hash(shared_secret)
    return pks, ss

def decaps(sk, ct):
    shared_secret = pow(ct, sk, m)
    ss = hash(shared_secret)
    return ss

